# Minecraft PussyRAT (Java) Malware Analysis


<img width="459" height="310" alt="image" src="https://github.com/user-attachments/assets/95e5d012-cd16-4316-93ca-813541a95889" />


**Analysis By:** Lil L3ak (vvg, lagoon, t4mpr)

**Date:** December 11, 2025


## Executive Summary

This analysis documents a sophisticated multi-stage Java-based Remote Access Trojan (RAT) campaign targeting the Minecraft gaming community. The malware, identified as "PussyRAT," is distributed through trojanized Minecraft Fabric mods and demonstrates advanced capabilities including:

- Multi-stage infection chain with in-memory payload execution
- Web cam access, credential stealer and Minecraft account hijacking
- Web-based C2 infrastructure with Discord OAuth authentication
- Module deployment system for additional payload delivery
- Persistent via registry modification




## Intro

On December 5th 2025, our team received a Java-based Minecraft RAT that had infected a friend’s machine.
The sample used a trojanized Fabric mod as its delivery mechanism, downloading a second-stage RAT and infostealer.

This malware shares significant overlap with `MaksStealer`, suggesting it is either a fork or heavily inspired variant.  `MaksStealer` malware has already been analyzed and a report of that analysis can be found at `https://github.com/ShadowOpCode/MaksStealer/blob/main/MaksStealer.pdf`.

The infection resulted in:

* Credential theft (browser cookies, tokens, Minecraft session files)

* Persistence via registry and dropped batch file

* DLL injection and named pipe communication

* Exfiltration to attacker-controlled VPS infrastructure




## Stage 1

The dropper.

`eab057ded8054b94efa28b32f7a6ad06  appleskin-fabric-mc1.21-3.0.6 (1).jar`

<img width="712" height="368" alt="image" src="https://github.com/user-attachments/assets/08f07db1-c40e-49e6-a5e1-10b251ff2ac4" />

**Malicious Capabilities:**

1. **Minecraft Session Hijacking**
   - Uses Java reflection to access Minecraft client session object
   - Extracts authentication tokens via `getSession()` method
   - Steals UUIDs and bearer tokens for account takeover
   - Target: `net.minecraft.client.MinecraftClient.getSession()`

2. **String Obfuscation System**
   - XOR-based encryption for all hardcoded strings
   - Dynamic key generation using seeded Random: `Random(-7953460202379592612L)`
   - Multiple byte array decryption routines to evade static analysis
   - Obfuscates C2 URLs, file paths, and API endpoints

3. **Control Flow Obfuscation**
   - Complex switch statements with computed hash values
   - Helper class `xhsrkjadbbteagqn` provides obfuscation functions:
     ```java
     public static int xqjrivcfsaehemeo(int i) {
         return (((i * 31) >>> 4) % i) ^ (i >>> 16);
     }
     ```
   - Exception-based control flow to confuse decompilers
   - Dead code insertion to increase analysis time



Using `cfr.jar` was able to get a decompilation of the jar.

`java -jar ~/Tools/cfr.jar appleskin-fabric-mc1.21-3.0.6\ \(1\).jar > appleskin_out`

<img width="756" height="623" alt="image" src="https://github.com/user-attachments/assets/d2cbc462-629e-47f3-ab27-adff9981097b" />

A large portion of the file are byte strings.

<img width="1166" height="197" alt="image" src="https://github.com/user-attachments/assets/bc0eb47f-a9e3-4ff9-bfd8-36be02a2a5a7" />

`https://github.com/skidfuscatordev/skidfuscator-java-obfuscator`

this is confimed by running an nmap on `104.198.24[.]41`


<img width="610" height="383" alt="image" src="https://github.com/user-attachments/assets/1226124b-5c51-47f7-a481-db665e4c3b5d" />

### Short detour on the nmap results of the server

When running the nmap we found alot more malicious files and infrastructure.

#### Discord server

The same nmap showed a Discord invite

<img width="749" height="84" alt="image" src="https://github.com/user-attachments/assets/8aed486e-590f-48a7-bcdb-baccd64c5068" />

<img width="279" height="236" alt="image" src="https://github.com/user-attachments/assets/46ee6c25-3e15-430f-a4b1-0e2a0e4f0982" />

<img width="1328" height="623" alt="image" src="https://github.com/user-attachments/assets/aede7542-7f43-4e5f-a8e3-4bd67716ec72" />

<img width="1330" height="586" alt="image" src="https://github.com/user-attachments/assets/4ae3166c-0bb0-49cb-8c48-fd33ce973b5b" />

<img width="1265" height="696" alt="image" src="https://github.com/user-attachments/assets/e3a9b4e9-d756-4ae0-a853-c428ce65cab3" />

<img width="665" height="422" alt="image" src="https://github.com/user-attachments/assets/857e3ad8-053b-4411-9a31-46605350cfe0" />

They are having a beef with another RAT creator and discord

<img width="485" height="571" alt="image" src="https://github.com/user-attachments/assets/8788c428-1edb-4649-8934-3f44a9efc9b2" />

 

<img width="369" height="557" alt="image" src="https://github.com/user-attachments/assets/56337aa3-9b8d-40b9-aa59-d0e154a858c3" />


When enumerating the second site we got a strange error which we believed to be the name/host of the creator. `/home/draniemaks8/frontend/`. This leads us to believe this the Discord of the creator.


<img width="292" height="223" alt="image" src="https://github.com/user-attachments/assets/b78435d8-fc19-4cc0-9abe-795bb6ec25e5" />

#### Minecraft servers??

<img width="630" height="417" alt="image" src="https://github.com/user-attachments/assets/ce50e3b8-7c38-489c-b0b1-e46b831d2ee4" />

`35565/tcp open     java-rmi         Java RMI`

#### Another website

<img width="713" height="228" alt="image" src="https://github.com/user-attachments/assets/0e494504-3860-4bf9-977c-ac457d69bcb6" />

#### Yet anothor website 


<img width="1621" height="100" alt="image" src="https://github.com/user-attachments/assets/9c059296-7c28-4bc5-ad60-e3bcfe0cac95" />

additionallibraries

## Was able to join discord ... another rat

<img width="1143" height="669" alt="image" src="https://github.com/user-attachments/assets/5b009ede-424b-4516-8dae-f4ce72145662" />

It seems like a rat factory, let people amek thier own version of the rat, rat people and share the c2 server. Below is a guide on how to use the stolen cookies

<img width="918" height="629" alt="image" src="https://github.com/user-attachments/assets/e25bb72f-8dab-420d-ba9b-809de3862d06" />




## Back to the malware

Found the TA posted the malware to the Hybrid Analysis on `November 30th 2025 19:10:08` with its original name.

`https://hybrid-analysis.com/sample/fc2a702ab9ef781b493e419c303abe659657761a5fa5cb938a894aea3ea59aa5/692c96900ce4f2640405189d`



<img width="1422" height="483" alt="image" src="https://github.com/user-attachments/assets/5f51e773-2f14-424e-a2a2-ad322d5dd09d" />


From here the dropper downloads 2 files from `www[.]donutaftersleep[.]shop`

`whois` of domain.

<img width="1144" height="655" alt="image" src="https://github.com/user-attachments/assets/afa42186-f07d-41d1-84fe-0182d42802c5" />



## Stage 2

Downloading the 2nd stage from `www[.]donutaftersleep[.]shop:4345`


<img width="1073" height="244" alt="image" src="https://github.com/user-attachments/assets/773c1745-54f0-41ca-bf1c-f4ba2ab65ebd" />


<img width="1157" height="208" alt="image" src="https://github.com/user-attachments/assets/0e4d266e-ddd9-4be9-b431-3e090f2c4568" />



<img width="805" height="111" alt="image" src="https://github.com/user-attachments/assets/1510cf18-a13a-4d5b-bc85-bfaffaafd83e" />

Quick look inside focusing on the Pussy classes

<img width="661" height="340" alt="image" src="https://github.com/user-attachments/assets/50f18503-fe67-4c83-a71c-4b673e939b57" />


<img width="648" height="93" alt="image" src="https://github.com/user-attachments/assets/fdd889c1-f070-4d9e-ab05-e72ddde75e75" />

The second stage is comprised of a similar Pussy functionality + the Encrypted byte string + lots on ancillary code.

<img width="1636" height="521" alt="image" src="https://github.com/user-attachments/assets/9d9283e6-79d0-4ac6-8176-c56163b01ed9" />

The byte string is simple XOR with a key at `var1165`. However what makes this annoying to reverse, is that the key changes after every use.

<img width="975" height="98" alt="image" src="https://github.com/user-attachments/assets/6aeaf545-a37d-4c1d-9e1b-be7a753e1d04" />


### Dynamic analysis

In order to conduct further analysis of the functionality we ran the executables in sand boxes. 

HybridAnalysis

`https://hybrid-analysis.com/sample/fff48b44c7afcf52fd59afdad027262fbed0d95597b0dfd25eaf518bd4ea929a/693397904593165f530a0c43`

Some of the same IP/urls show up again with new one, `avocado.gay`.

<img width="1404" height="784" alt="image" src="https://github.com/user-attachments/assets/e507dbb6-432a-4277-baf9-3b8404e7411e" />


VirusTotal
`https://www.virustotal.com/gui/file/fff48b44c7afcf52fd59afdad027262fbed0d95597b0dfd25eaf518bd4ea929a/`

`whois` of domain

<img width="1154" height="711" alt="image" src="https://github.com/user-attachments/assets/1e484c02-a622-4460-bc55-53bd73f0f0f4" />


The `whois` of `foldacces[.]com` shows this domain is the newest of the bunch. 

<img width="1136" height="543" alt="image" src="https://github.com/user-attachments/assets/ea4d061f-9b71-4f39-9831-5f4cdf9ecfb9" />




A `whois` of `www[.]maksagain[.]fun`.

<img width="1038" height="509" alt="image" src="https://github.com/user-attachments/assets/9eb04c85-b446-4124-b7dd-1964b9ad2895" />


### Exfil

1. Stolen data collected into temporary directory
2. Packaged into ZIP archive with unique victim identifier
3. Base64 encoded for HTTP transmission
4. Transmitted via HTTP POST to C2: `POST /api/exfil`
5. Local evidence cleaned (ZIP deleted after successful upload)


The pcap capture from HybridAnalysis shows the exfiltrated data

<img width="1831" height="699" alt="image" src="https://github.com/user-attachments/assets/2d6bfe83-f140-4be9-bd5a-1a2f8db640ed" />

After base64 decoding the stream we can see the contents of the zip. It includes cookies, Discord information and a screenshot. 

<img width="1648" height="566" alt="image" src="https://github.com/user-attachments/assets/2f66fcb0-f892-4629-8355-32c59bcb8c23" />

The `Log.txt` file shows the actions taken by the second stage which include creating a named pipe and injecting a dll.

<img width="1646" height="710" alt="image" src="https://github.com/user-attachments/assets/2e5d1b36-34d8-4d9b-b81a-3f38bfc0966d" />

Below is an example of the cookies it stole from the Edge browser.

<img width="1648" height="268" alt="image" src="https://github.com/user-attachments/assets/d6ae4a36-4502-46ec-ad91-119c0682ca9d" />


### c2

<img width="560" height="150" alt="image" src="https://github.com/user-attachments/assets/2e5b3a8a-6c69-441a-b0b8-865e527b486b" />

#### Persistence

Dropped `.bat`

<img width="941" height="140" alt="image" src="https://github.com/user-attachments/assets/302cb0a9-b62d-49c7-89c2-10895f9206ee" />


Registry key 

`cmd /c "reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Run" /v "javacom" /t REG_SZ /d "%APPDATA%\AutoStartMini\javacom-run.bat" /f"`


#### Client 



<img width="1043" height="340" alt="image" src="https://github.com/user-attachments/assets/b31d9223-1917-43aa-92a5-781eeb299e47" />

<img width="1051" height="446" alt="image" src="https://github.com/user-attachments/assets/27407395-8391-474a-9e49-12f20cc40ae6" />


#### Server

Visiting the donut or the avocado site we are greeded with a login, a local login or a user auth through discord. There are a variety of endpoints some leaking information, pther behind a paywall,

After signing in must buy 'premium'. 

<img width="1120" height="369" alt="image" src="https://github.com/user-attachments/assets/d9abbf92-8192-4f9a-b0e1-317ab289b091" />

the server code is able to be obtained at `/server.js`.  They can be visited unauthenticat, authenticated and discord

<img width="1383" height="489" alt="image" src="https://github.com/user-attachments/assets/c3eaeb78-8e5f-4630-9671-2cb8f3def8f5" />



<img width="1046" height="804" alt="image" src="https://github.com/user-attachments/assets/97238776-8b53-47ac-a51d-3022a6c39c15" />

`avocado[.]gay` contains the same infrastructure.

<img width="1464" height="713" alt="image" src="https://github.com/user-attachments/assets/b242ba36-cbc8-42ca-9687-a5e05c0dc6e5" />


Can sign in with a burner discord to firther enumerate the server.

`https://avocado[.]gay/api/debug/jobs`


<img width="407" height="237" alt="image" src="https://github.com/user-attachments/assets/a4252f03-b34a-4a2b-aa97-fc13b5f76a63" />


<img width="522" height="621" alt="image" src="https://github.com/user-attachments/assets/f52a0de7-2f90-4d37-8202-352b3d72f597" />


one of the endpoints for downloding `modules` has another `RemoteAccess.jar`.

`https://avocado.gay/modules/RemoteAccess[.]jar`

`7332a63ae701772ff765221e8e487553  RemoteAccess.jar`

<img width="755" height="194" alt="image" src="https://github.com/user-attachments/assets/24160ee7-6808-4835-a15a-bcb2f3591196" />




## OSINT of author

Found his youtube from the Discord server

<img width="713" height="714" alt="image" src="https://github.com/user-attachments/assets/a2aad55a-0602-4d1f-a036-b1973e339b8f" />


Their main ign is MaksVavrik, their main email is maksvavrik86@gmail.com

Their second email is:
maksvavrik@rambler

Their hypixel account: https://hypixel.net/members/maksvavrik1.4100659/about



Their youtube channel, where they proudly teach you to also RAT, while advertising mods which I checked are RATs: https://www.youtube.com/@HarpSkyblock


Their mc account: https://namemc.com/skin/11c20c8de9ac0666
1. Forum they sell shit on: https://odealo.com/games/minecraft-hypixel/profiles/offer_25276670
2. Forum they sell and speak shit on: 
https://forums.goha.ru/showthread_69_0_t1372209--Single+Multiplayer+%D0%98%D0%BD%D0%B4%D0%B8+%D0%B8+%D0%B4%D1%80%D1%83%D0%B3%D0%B8%D0%B5+%D0%B8%D0%B3%D1%80%D1%8B+Minecraft+%D0%A5%D1%80%D0%B0%D0%BD%D0%B5%D0%BD%D0%B8%D0%BD+%D0%BF%D0%B0%D1%80%D0%BE%D0%BB%D0%B5%D0%B9+%D0%BC%D0%B0%D0%B9%D0%BD%D0%BA%D1%80%D0%B0%D1%84%D1%82

3. https://ru-minecraft.ru/forum/showtopic-24252/

4. this is a mc modding one for Russians https://forum.mcmodding.ru/threads/mixin-replace-name.34258/

5. https://ru-minecraft.ru/forum/showtopic-24252/

Their python profile: https://pypi.org/user/MaksVavrik/
Auction they held with stolen item: https://sky.coflnet.com/auction/849d43721ade4d39a5f41202584b64cf

 bedwars stats: https://shmeado.club/player/stats/MaksVavrik/

Ironically Russian victim reporting to microsoft, microsoft basically telling them to kys: https://learn.microsoft.com/ru-ru/answers/questions/4089900/question-4089900

![[image-34.png]]

https://pypi.org/e4.sitemap.xml

## youtube
[https://www.youtube.com/@HarpSkyblock/videos](https://www.youtube.com/@HarpSkyblock/videos "https://www.youtube.com/@HarpSkyblock/videos")
  
https://www.youtube.com/watch?v=hktYW91qPq8

[https://www.youtube.com/channel/UCVKqTqrTTMrEQ56zCiFkM1Q](https://www.youtube.com/channel/UCVKqTqrTTMrEQ56zCiFkM1Q "https://www.youtube.com/channel/UCVKqTqrTTMrEQ56zCiFkM1Q")

[https://www.youtube.com/@Iaintsteel](https://www.youtube.com/@Iaintsteel "https://www.youtube.com/@Iaintsteel")

![[image-52.png]]

### possible friend of vavrik?
[https://ru-minecraft.ru/user/vovanhurcane/](https://ru-minecraft.ru/user/vovanhurcane/ "https://ru-minecraft.ru/user/vovanhurcane/")




### possible facebook?

[https://www.facebook.com/p/Максим-Ваврик-100022120193386/](https://www.facebook.com/p/%D0%9C%D0%B0%D0%BA%D1%81%D0%B8%D0%BC-%D0%92%D0%B0%D0%B2%D1%80%D0%B8%D0%BA-100022120193386/ "https://www.facebook.com/p/Максим-Ваврик-100022120193386/")

## The threat actor's discord server
[https://discord.gg/742vrsD3WF](https://discord.gg/742vrsD3WF "https://discord.gg/742vrsD3WF")

![[image-36.png]]

![[image-37.png]]

![[image-38.png]]

![[image-39.png]]

![[image-41.png]]

![[image-40.png]]







## IOCs

### Executables

| File | MD5 Hash | SHA256 (if available) | Purpose |
|------|----------|----------------------|---------|


```
eab057ded8054b94efa28b32f7a6ad06  appleskin-fabric-mc1.21-3.0.6 (1).jar
46d05fdaa78f76e0c4cb99f11edc55eb  downloaded.jar
2f8c264728f92c3a76a910f02033eece  JavaInt.jar
05a39f1a7e25331650417b688c000c3b  additionallibraries.jar
7332a63ae701772ff765221e8e487553  RemoteAccess.jar
```
### Network Infrastructure

| Domain/IP | Port(s) | Purpose | Status |
|-----------|---------|---------|--------|


```
www[.]donutaftersleep[.]shop 	104.198.24[.]41 
www[.]foldacces[.]online 	104.198.24[.]41
avocado[.]gay 	104.21.22[.]84
test-q8cm.onrender[.]com 216.24.57[.]7
```

## Rules

first draft yara rule to detect the executables
### YARA
```
rule PussyRAT_Java_Malware {
    meta:
        description = "Detects PussyRAT/MaksStealer Java malware"
        author = "Lil L3ak"
        date = "2025-12-09"

    strings:
        $s1 = "Pussy/PussyClient" ascii
        $s2 = "Pussy/Pussss" ascii
        $s3 = "qupvnjxdvlazbvuc/xhsrkjadbbteagqn" ascii
        $s4 = "nothing_to_see_here" ascii
        $s5 = "net.fabricmc.api.ClientModInitializer" ascii
        $s6 = "maksrat" ascii nocase
        $s7 = "HeadlessClientMain" ascii

        $hex1 = { 48 6B 4E 28 20 07 25 24 5B 71 59 10 } // XOR key pattern

    condition:
        (uint16(0) == 0x4B50) and  // ZIP/JAR signature
        (
            (2 of ($s1,$s2,$s3,$s4,$s5)) or
            (1 of ($s6,$s7)) or
            $hex1
        )
}


```

### sigma

```
title: PussyRAT Suspicious Minecraft Fabric Mod Execution
id: k7p3n8o2-9m4l-4k1n-8o7p-3l2m9n5o6p7q
status: experimental
description: Detects execution of Minecraft with suspicious Fabric mod from unusual locations, indicative of PussyRAT stage 1 dropper
references:
    - Internal research
author: Lil L3ak
date: 2025-12-11
modified: 2025-12-11
tags:
    - attack.execution
    - attack.t1204.002
logsource:
    category: process_creation
    product: windows
detection:
    selection_java:
        - Image|endswith:
            - '\java.exe'
            - '\javaw.exe'
        - OriginalFileName:
            - 'java.exe'
            - 'javaw.exe'
    selection_minecraft:
        CommandLine|contains:
            - 'minecraft'
            - 'fabric'
            - 'fabricmc'
    selection_suspicious_mod_path:
        CommandLine|contains:
            - '\Downloads\'
            - '\Desktop\'
            - '\Temp\'
            - '\Users\Public\'
    selection_classloader_indicators:
        CommandLine|contains:
            - 'Pussy'
            - 'qupvnjxdvlazbvuc'
    condition: selection_java and selection_minecraft and (selection_suspicious_mod_path or selection_classloader_indicators)
falsepositives:
    - Users running Minecraft mods from non-standard lo
```

```
title: PussyRAT Malicious Module Deployment to Public Folder
id: g3l9j4k8-5i0h-0g7j-4k3l-9h8i5j1k2l3m
status: experimental
description: Detects creation of JAR files in C:\Users\Public\Modules directory used by PussyRAT for module deployment
references:
    - Internal research
author: Lil L3ak
date: 2025-12-11
modified: 2025-12-11
tags:
    - attack.execution
    - attack.t1204.002
logsource:
    category: file_event
    product: windows
detection:
    selection:
        TargetFilename|contains: 'C:\Users\Public\Modules\'
        TargetFilename|endswith: '.jar'
    condition: selection
falsepositives:
    - Legitimate Java module deployment (rare in this directory)
level: high

```


